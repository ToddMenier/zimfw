_zimfw_build() {
  () {
    local -r ztarget=${ZIM_HOME}/init.zsh
    if [[ ${ztarget} -nt <%= home %>/.zimrc ]] && command cmp -s ${ztarget} ${1}; then
      if (( ! _zquiet )); then
        print -PR "<%= okay %>%B${ztarget}:%b Already up to date"
      fi
    else
      if [[ -e ${ztarget} ]]; then
        command mv -f ${ztarget}{,.old} || return 1
      fi
      command mv -f ${1} ${ztarget} && \
          if (( ! _zquiet )); then
            print -PR "<%= okay %>%B${ztarget}:%b Updated. Restart your terminal for changes to take effect."
          fi
    fi
    if (( ! _zquiet )); then
      print -P '<%= done %>Done with build.'
    fi
  } =(
    print -R "zimfw() { source ${ZIM_HOME}/<%= script_filename %> \"\${@}\" }"
    (( ${#_zfpaths} )) && print -R 'fpath=('${_zfpaths:P}' ${fpath})'
    (( ${#_zfunctions} )) && print -R 'autoload -Uz '${_zfunctions}
    print -Rn ${(F):-source ${^_zscripts:P}}
  )
}
